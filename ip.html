<!DOCTYPE html>
<html>
<body>
  <h1>Connect to Pi Zero</h1>
  <button id="connect">Find Pi IP</button>
  <p id="status">Status: Disconnected</p>
  <h2 id="ip-display">IP Address: --</h2>

  <script type="module">
    const SERVICE_UUID = '12345678-1234-5678-1234-56789abcdef0'; // Must match Pi
    const CHAR_UUID = '12345678-1234-5678-1234-56789abcdef1';

    document.getElementById('connect').addEventListener('click', async () => {
      try {
        const device = await navigator.bluetooth.requestDevice({
          filters: [{ namePrefix: 'AlpinePi' }],
          optionalServices: [SERVICE_UUID]
        });

        const server = await device.gatt.connect();
        const service = await server.getPrimaryService(SERVICE_UUID);
        const characteristic = await service.getCharacteristic(CHAR_UUID);
        
        const value = await characteristic.readValue();
        const decoder = new TextDecoder('utf-8');
        
        document.getElementById('ip-display').innerText = `IP Address: ${decoder.decode(value)}`;
        document.getElementById('status').innerText = "Status: Connected";
      } catch (error) {
        console.error(error);
      }
    });
  </script>
</body>
</html>
